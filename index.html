<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ğŸ¬ L'Ultima Notte al Billionaire</title>
  <meta name="description" content="Cena con Delitto - Capodanno 2025">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¬</text></svg>">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { margin: 0; padding: 0; background: #0f0a1e; min-height: 100vh; overflow-x: hidden; }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: #1e1b4b; }
    ::-webkit-scrollbar-thumb { background: #7c3aed; border-radius: 4px; }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    .float { animation: float 3s ease-in-out infinite; }
    @keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(1.5); opacity: 0; } }
    .pulse-ring { animation: pulse-ring 1.5s ease-out infinite; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useCallback } = React;

    // ============== CONFIGURAZIONE PERSONAGGI (dal PDF) ==============
    const PERSONAGGI = [
      {
        nome: "Giacomo", soprannome: "Jacku",
        celebrita: "Michael Phelps", icona: "ğŸŠ", ruolo: "Il Nuotatore Leggendario",
        background: `Sei Michael Phelps, il nuotatore piÃ¹ medagliato della storia olimpica. 23 ori olimpici. Leggenda vivente.
        
Sei gentile, disponibile e solare. Hai un'aura di tranquillitÃ  che mette tutti a proprio agio.

Briatore ti ha invitato come testimonial per una nuova linea di resort di lusso con spa e piscine olimpioniche.`,
        segreto: `Hai un grave problema di gioco d'azzardo. Hai perso 4 milioni di dollari in scommesse sportive illegali. Briatore possiede il casinÃ² clandestino dove hai accumulato i debiti. Ti ha "prestato" i soldi ma ora pretende che tu faccia da testimonial gratuito per 10 anni.

Quella sera, Briatore ti ha comunicato che vuole anche il 30% dei tuoi futuri guadagni, altrimenti rivelerÃ  tutto.`,
        alibi: `â€¢ 22:00-22:30 â†’ Salone principale, parlavi con Del Piero di sport
â€¢ 22:30-23:00 â†’ Terrazza, da solo, "a prendere aria"
â€¢ 23:00-23:30 â†’ Bagno e poi cucina a prendere dell'acqua
â€¢ 23:30-23:47 â†’ Salone principale`,
        potere: '"VASCA DOMINANTE" - Una volta puoi sfidare qualcuno: DEVE rispondere a una domanda diretta onestamente.'
      },
      {
        nome: "Elena", soprannome: "Elenina",
        celebrita: "Kronk", icona: "ğŸ‘¨â€ğŸ³", ruolo: "Lo Chef della Serata",
        background: `Sei Kronk, l'ex guardia del corpo dell'Imperatore Kuzco, ora diventato famoso chef televisivo. Il tuo programma "Cucina con Kronk" Ã¨ un successo mondiale.

Sei sorridente, creativa, un po' ingenua ma con un cuore d'oro. Parli spesso con la tua "coscienza" immaginaria.

Sei stata assunta per preparare il menu della serata. Il tuo sogno Ã¨ aprire un panificio, e Briatore ti aveva promesso di finanziarlo.`,
        segreto: `Non sai davvero cucinare! Tutti i tuoi piatti televisivi sono preparati da un team segreto di chef. Briatore l'ha scoperto quando ti ha vista bruciare un toast. Ti ricatta per il 50% del futuro panificio.

MA C'Ãˆ DI PIÃ™: Tua sorella Sofia lavorava sullo yacht di Briatore. Tre anni fa, lui l'ha aggredita. Sofia oggi Ã¨ in clinica per depressione. L'hai scoperto solo 6 mesi fa.`,
        alibi: `â€¢ 22:00-22:30 â†’ In cucina a supervisionare
â€¢ 22:30-22:40 â†’ Hai parlato con Bradley Cooper in cucina
â€¢ 22:40-23:15 â†’ Uscita a fumare nel cortile interno
â€¢ 23:15-23:40 â†’ In cantina a prendere champagne
â€¢ 23:40-23:47 â†’ Tornata nel salone`,
        potere: '"FATTO IN CASA" - Una volta puoi appartarti con un giocatore per 2 minuti e scambiarvi informazioni liberamente.'
      },
      {
        nome: "Rachele", soprannome: "Rachi",
        celebrita: "Giulia Calcaterra", icona: "ğŸ’ª", ruolo: "L'Influencer Fitness",
        background: `Sei Giulia Calcaterra, influencer fitness, ex Velina, imprenditrice digitale. Milioni di follower ti seguono per i workout e lo stile di vita sano.

Sei testarda come un mulo, molto selettiva nelle amicizie, tendi a essere bronciosa quando le cose non vanno come vuoi. Ma hai un dono: vedi il buono in quasi tutte le persone.

Briatore voleva che diventassi l'immagine del suo nuovo resort fitness in Sardegna.`,
        segreto: `Usi segretamente steroidi anabolizzanti per mantenere il tuo fisico. Le tue analisi del sangue, che Briatore ha ottenuto corrompendo un medico, lo dimostrano.

Briatore voleva che tu convincessi altri influencer a promuovere un integratore pericoloso ma redditizio. Se avessi rifiutato, avrebbe pubblicato le analisi.`,
        alibi: `â€¢ 22:00-22:30 â†’ Nel salone, facevi stories su Instagram
â€¢ 22:30-23:00 â†’ In bagno a lungo ("problemi di stomaco")
â€¢ 23:00-23:20 â†’ Sul terrazzo con Rihanna
â€¢ 23:20-23:47 â†’ Salone principale`,
        potere: '"WORKOUT CHALLENGE" - Una volta puoi sfidare qualcuno: se "perde", deve rivelare dove si trovava in un momento specifico.'
      },
      {
        nome: "Filippo", soprannome: "Pippo",
        celebrita: "Kobe Bryant", icona: "ğŸ€", ruolo: "La Leggenda del Basket",
        background: `Sei Kobe Bryant, la leggenda del basket, 5 volte campione NBA. (In questa storia alternativa, Kobe Ã¨ ancora vivo). Noto per la tua "Mamba Mentality" - determinazione assoluta.

Sei cocciuto, furbetto e curioso. Hai un'energia contagiosa e sai coinvolgere le persone. Quando ti impegni in qualcosa, vai fino in fondo.

Stai lanciando una linea di abbigliamento sportivo e Briatore era un potenziale investitore.`,
        segreto: `La famosa "Mamba Mentality" nasconde anni di uso di sostanze per migliorare le prestazioni. Briatore ha in cassaforte una confessione video di un ex preparatore atletico.

Briatore chiedeva 10 milioni di euro per distruggere il video. Hai rifiutato. Quella sera ti ha dato l'ultimatum: paga entro mezzanotte o il 1Â° gennaio il video sarÃ  online.`,
        alibi: `â€¢ 22:00-22:20 â†’ Salone, parlavi con Luka Doncic di basket
â€¢ 22:20-22:50 â†’ Salito al piano superiore "per una telefonata privata"
â€¢ 22:50-23:30 â†’ Backstage, dicevi di cercare tua moglie
â€¢ 23:30-23:47 â†’ Tornato nel salone`,
        potere: '"MAMBA MENTALITY" - Una volta puoi fissare qualcuno negli occhi e chiedergli: "Stai mentendo?" DEVE rispondere sinceramente.'
      },
      {
        nome: "Alberto T.", soprannome: "Tegolina",
        celebrita: "Jannik Sinner", icona: "ğŸ¾", ruolo: "Il Tennista N.1",
        background: `Sei Jannik Sinner, il tennista italiano numero 1 al mondo. Giovane, talentuoso, apparentemente con i piedi per terra.

Sei simpatico e socievole. Quando sei alle feste con gli amici, ami bere e divertirti - un lato che il pubblico non conosce.

Briatore ti ha promesso contratti pubblicitari milionari.`,
        segreto: `Sei stato coinvolto involontariamente in un giro di scommesse clandestine. Alcuni tuoi match minori sono stati "aggiustati" a tua insaputa dal tuo ex manager, ma le prove potrebbero incastrare anche te.

Briatore voleva che tu "perdessi" intenzionalmente la finale degli Australian Open per far vincere una scommessa da 20 milioni. Hai rifiutato categoricamente.`,
        alibi: `â€¢ 22:00-22:40 â†’ Al bar, bevevi con Del Piero e Phelps
â€¢ 22:40-23:10 â†’ In terrazza, sembravi alterato dall'alcol
â€¢ 23:10-23:35 â†’ Nessuno ti ha visto (dici di essere andato in bagno a vomitare)
â€¢ 23:35-23:47 â†’ Riapparso nel salone, pallido`,
        potere: '"OCCHIO DI FALCO" - Una volta puoi richiedere una "revisione": un giocatore deve darti UN indizio su dove si trovava.'
      },
      {
        nome: "Cate", soprannome: "Santoni",
        celebrita: "Zendaya", icona: "ğŸ¬", ruolo: "La Star di Hollywood",
        background: `Sei Zendaya, attrice di Hollywood, star di Euphoria e dei film Spider-Man. Icona di stile e talento.

Parli tantissimo ma sei incredibilmente indecisa. Ci metti mezz'ora a scegliere cosa bere. Ma sei anche testarda: quando finalmente decidi qualcosa, non torni indietro.

Briatore vuole produrre un film con te come protagonista.`,
        segreto: `Hai avuto una relazione segreta con Briatore stesso, 3 anni fa, quando avevi appena compiuto 18 anni. Lui ha foto e messaggi. Se uscissero, la tua immagine "pulita" sarebbe distrutta.

Briatore ti ricattava per costringerti a firmare un contratto capestro per 3 film. Hai detto no. Lui ha minacciato di pubblicare tutto a mezzanotte.`,
        alibi: `â€¢ 22:00-22:30 â†’ Salone, parlavi con Rihanna di musica e moda
â€¢ 22:30-23:00 â†’ Suite al piano di sopra per "ritoccare il trucco"
â€¢ 23:00-23:15 â†’ Sei stata vista scendere le scale, avevi pianto
â€¢ 23:15-23:47 â†’ Nel salone, silenziosa`,
        potere: '"EUPHORIA" - Una volta puoi creare confusione: tutti devono dire una cosa che hanno fatto stasera, partendo da chi scegli tu.'
      },
      {
        nome: "Alberto F.", soprannome: "Fava",
        celebrita: "Alex Del Piero", icona: "âš½", ruolo: "La Leggenda della Juventus",
        background: `Sei Alex Del Piero, leggenda della Juventus e della Nazionale italiana. Capitano, goleador, gentleman dello sport.

Sei prudente e riflessivo, pensi sempre tre volte prima di agire. Simpatico e amato da tutti.

Vecchia amicizia con Briatore dai tempi della Juventus e del jet-set torinese.`,
        segreto: `Hai investito tutti i tuoi risparmi (circa 30 milioni) in una startup consigliata da Briatore. La startup era una TRUFFA e Briatore ha intascato i soldi. L'hai scoperto da poco.

Briatore ti ha deriso quando hai chiesto indietro i soldi: "Sei ingenuo, Pinturicchio. I soldi sono miei."

âš ï¸ NOTA IMPORTANTE: HAI effettivamente avvelenato i sigari con cianuro. Ma il sigaro avvelenato era il TERZO della fila. Briatore ha fumato il PRIMO. Qualcun altro l'ha ucciso PRIMA.`,
        alibi: `â€¢ 22:00-22:30 â†’ Al bar con Sinner e Phelps
â€¢ 22:30-23:10 â†’ In cucina, parlavi con lo staff (controllavi i sigari)
â€¢ 23:10-23:30 â†’ Terrazza, fumavi un sigaro (non avvelenato)
â€¢ 23:30-23:47 â†’ Salone`,
        potere: '"ROVESCIO PERFETTO" - Una volta puoi "ribaltare" un\'accusa: chi ti accusa deve rivelare un suo segreto.'
      },
      {
        nome: "Chiara", soprannome: "Victor",
        celebrita: "Will Smith", icona: "ğŸ­", ruolo: "L'Attore Premio Oscar",
        background: `Sei Will Smith, attore premio Oscar, rapper, una delle star piÃ¹ famose al mondo. Dopo lo "schiaffo" agli Oscar, stai cercando di ricostruire la tua immagine.

Sei espressivo all'estremo: puoi passare dalla risata al pianto in 3 secondi. A giorni alterni sei simpaticissimo o intrattabile.

Briatore ti ha promesso un ruolo da protagonista in un film biografico su Enzo Ferrari.`,
        segreto: `Hai problemi di gestione della rabbia molto piÃ¹ gravi di quanto mostrato agli Oscar. Hai aggredito fisicamente altre persone in passato e Briatore ha i video di almeno 3 episodi violenti.

Briatore pretendeva che tu facessi da testimonial gratuito per tutti i suoi locali.

âš ï¸ NOTA IMPORTANTE: HAI tentato di uccidere Briatore con una siringa. Ma quando sei entrato nell'ufficio, Briatore era GIÃ€ MORTO. Pensi di essere l'assassino, ma NON lo sei.`,
        alibi: `â€¢ 22:00-22:45 â†’ Salone, facevi il simpatico con tutti
â€¢ 22:45-23:05 â†’ Backstage, "cercavi un posto tranquillo"
â€¢ 23:05-23:10 â†’ Hai rubato una siringa dalla suite di Blake Lively
â€¢ 23:10-23:25 â†’ Nessuno sa dove fossi (eri nell'ufficio di Briatore)
â€¢ 23:25-23:47 â†’ Riapparso nel salone, sudato e agitato`,
        potere: '"SCHIAFFO DI VERITÃ€" - Una volta puoi "schiaffeggiare" verbalmente qualcuno: DEVE confessare se ha mentito su qualcosa.'
      },
      {
        nome: "Camilla", soprannome: "Cami",
        celebrita: "Rihanna", icona: "ğŸ¤", ruolo: "La Superstar Globale",
        background: `Sei Rihanna, superstar globale, imprenditrice miliardaria con Fenty Beauty e Savage X Fenty. Icona della musica e della moda.

Sei ironica e tagliente, ami fare festa, dai ottimi consigli agli altri (ma non li segui per te stessa). Stile vintage, disinibita e libera.

Briatore voleva che tu cantassi al party e promuovessi il Billionaire come "il locale delle star".`,
        segreto: `Devi 15 milioni di euro a Briatore. Li avevi chiesti in prestito anni fa per lanciare Fenty, prima che diventasse un successo. Briatore vuole indietro il TRIPLO: 45 milioni. Ha i contratti firmati.

Briatore minacciava di rendere pubblico il debito e di trascinarti in tribunale, rovinando l'immagine di "self-made billionaire".`,
        alibi: `â€¢ 22:00-22:30 â†’ Salone, parlavi con Zendaya
â€¢ 22:30-23:00 â†’ Sul palco per le prove del soundcheck
â€¢ 23:00-23:20 â†’ Terrazza con Giulia Calcaterra
â€¢ 23:20-23:47 â†’ Salone`,
        potere: '"SHINE BRIGHT" - Una volta puoi mettere qualcuno "sotto i riflettori": deve rispondere a 3 domande di fila.'
      },
      {
        nome: "Claudia", soprannome: "Claudie",
        celebrita: "Blake Lively", icona: "ğŸ‘—", ruolo: "L'Icona di Stile",
        background: `Sei Blake Lively, attrice di Hollywood, icona di stile, moglie di Ryan Reynolds. Star di "Gossip Girl" e "A Simple Favor".

Sei affidabile, dinamica, determinata. Un po' lunatica a volte. Ami la moda, i viaggi, e hai un'intelligenza emotiva molto sviluppata. Capisci le persone al volo.

Briatore vuole che tu sia la protagonista di una serie TV ambientata nel mondo del lusso.`,
        segreto: `Hai avuto una breve relazione con Briatore PRIMA di sposare Ryan Reynolds. Briatore ha foto e video intimi. Se uscissero, il tuo matrimonio e la tua immagine sarebbero distrutti.

Briatore ti ricattava per costringerti a lasciare Ryan e tornare con lui. Hai rifiutato. Lui ha minacciato di mandare tutto a Ryan e ai tabloid.

âš ï¸ NOTA: Usi siringhe per trattamenti estetici. Una delle tue siringhe Ã¨ SPARITA quella sera.`,
        alibi: `â€¢ 22:00-22:30 â†’ Salone, parlavi con Zendaya e Rihanna di moda
â€¢ 22:30-23:00 â†’ Sala massaggi per un trattamento rilassante
â€¢ 23:00-23:10 â†’ Nella tua suite a cambiarti
â€¢ 23:10-23:47 â†’ Salone principale`,
        potere: '"GOSSIP GIRL" - Una volta puoi rivelare un pettegolezzo: scegli due giocatori che devono confermare o smentire.'
      },
      {
        nome: "Andrea", soprannome: "Poppi",
        celebrita: "Luka Doncic", icona: "ğŸ€", ruolo: "Il Fenomeno Sloveno",
        background: `Sei Luka Doncic, il fenomeno sloveno del basket NBA, uno dei giocatori piÃ¹ forti del mondo. Giovane, talentuoso, con un sorriso contagioso.

Sei buono d'animo, scherzi sempre, un po' disorganizzato. Ami correre, il basket ovviamente, e la tua ragazza.

Briatore ti ha proposto di investire in una squadra di basket europea.`,
        segreto: `Hai accidentalmente investito una persona con l'auto 2 anni fa a Lubiana. Eri sotto effetto dell'alcol. Briatore ha pagato per insabbiare tutto, ma ora pretende che tu sia il suo "ambasciatore" gratuito per sempre.

Briatore aveva minacciato di far riaprire l'indagine se non avessi convinto altri giocatori NBA a partecipare ai suoi eventi.`,
        alibi: `â€¢ 22:00-22:20 â†’ Salone, parlavi con Kobe Bryant
â€¢ 22:20-23:00 â†’ Al bar, bevevi e parlavi al telefono con la ragazza
â€¢ 23:00-23:40 â†’ Nel cortile esterno, "a prendere aria"
â€¢ 23:40-23:47 â†’ Rientrato nel salone`,
        potere: '"STEP-BACK" - Una volta puoi fare un passo indietro e chiedere a tutti: "Chi aveva un motivo per uccidere Briatore?"'
      },
      {
        nome: "Annastella", soprannome: "Stella",
        celebrita: "Bradley Cooper", icona: "ğŸ¬", ruolo: "L'Attore Perfezionista",
        background: `Sei Bradley Cooper, attore e regista pluripremiato, star di Hollywood. Nominato piÃ¹ volte agli Oscar per "A Star Is Born", "American Sniper" e "Maestro". Perfezionista assoluto.

Sei maniaco dell'organizzazione nei minimi dettagli. Odi i cambi di programma all'ultimo minuto. Tutto deve essere pianificato alla perfezione. Veloce in tutto, efficiente.

Briatore ti ha proposto di dirigere un documentario sulla sua vita.`,
        segreto: `Il tuo segreto pubblico: hai avuto problemi di dipendenza da cocaina negli anni 2000. Ma quello che non hai mai detto Ã¨ che hai causato un incidente sul set che ha ferito uno stuntman. Briatore ha le carte dell'accordo segreto.

âš ï¸ IL TUO VERO SEGRETO (che nessuno conosce):
Eri il FIDANZATO SEGRETO di Sofia, la sorella di Kronk. Stavate per sposarvi.
Poi Sofia ha lavorato sullo yacht di Briatore. Una notte, Briatore l'ha violentata.
Sofia si Ã¨ allontanata da te senza spiegarti perchÃ©. Un anno fa ha tentato il suicidio e ti ha scritto una lettera confessandoti tutto.

HAI GIURATO VENDETTA.`,
        alibi: `â€¢ 22:00-22:20 â†’ Salone, parlavi con Will Smith
â€¢ 22:20-22:45 â†’ Sala massaggi (DICI)
â€¢ 22:45-23:10 â†’ Suite al piano superiore (DICI)
â€¢ 23:10-23:30 â†’ Corridoio vicino alla cucina, sembravi nervoso
â€¢ 23:30-23:47 â†’ Salone

âš ï¸ IN REALTÃ€:
â€¢ 22:25-22:40 â†’ Eri IN CUCINA con Kronk
â€¢ Hai versato la RICINA nel risotto di Briatore`,
        potere: '"METODO STANISLAVSKIJ" - Una volta puoi "entrare nel personaggio" di un sospettato e fare domande come se fossi lui/lei.'
      }
    ];

    // INDIZI (dal PDF)
    const INDIZI = [
      { 
        id: 1, 
        titolo: 'ğŸ“© INDIZIO #1 - I Sigari Avvelenati',
        contenuto: `ğŸ” SCENA DEL CRIMINE - L'ufficio di Briatore

Sul corpo di Briatore sono state trovate TRE anomalie:
1. Un sigaro cubano spento, con tracce di CIANURO
2. Residui di veleno nei denti - qualcosa di INGERITO
3. Un piccolo foro sulla spalla - puntura di siringa

La scatola di sigari era un regalo. Un'incisione:
"A Flavio, il migliore affare della mia vita. - A.D.P."

ğŸ“ A.D.P. = Alex Del Piero?

âš ï¸ MA ECCO IL MISTERO:
Il sigaro avvelenato era il TERZO nella scatola.
Briatore stava fumando il PRIMO.
Il cianuro non l'ha mai raggiunto.

ğŸ¯ CONCLUSIONE: Qualcuno ha TENTATO di ucciderlo con i sigari, ma qualcun altro Ã¨ stato piÃ¹ veloce...`
      },
      { 
        id: 2, 
        titolo: 'ğŸ“© INDIZIO #2 - La Siringa Misteriosa',
        contenuto: `ğŸ” SECONDA ANOMALIA - Il foro sulla spalla

L'analisi forense rivela qualcosa di STRANO:
La puntura Ã¨ stata fatta POST-MORTEM.
Briatore era giÃ  MORTO quando qualcuno l'ha punto.

ğŸ­ Will Smith Ã¨ sparito per 15 minuti (23:10-23:25).
Un addetto l'ha sentito urlare: "Ti ammazzo! Giuro che ti ammazzo!"

ğŸ‘  Blake Lively usa siringhe per trattamenti estetici.
Una Ã¨ SPARITA dalla sua suite quella sera.

âš ï¸ COLPO DI SCENA:
Will Smith Ã¨ entrato nell'ufficio per uccidere Briatore.
Ma ha trovato un CADAVERE.

ğŸ¯ CONCLUSIONE: Due tentativi di omicidio FALLITI.
â€¢ Del Piero â†’ Sigari avvelenati (Briatore non l'ha fumato)
â€¢ Will Smith â†’ Siringa (Briatore era giÃ  morto)

Ma allora CHI l'ha ucciso? La risposta Ã¨ nel VELENO INGERITO...`
      },
      { 
        id: 3, 
        titolo: 'ğŸ“© INDIZIO #3 - Il Veleno nel Cibo',
        contenuto: `ğŸ” TERZA ANOMALIA - Veleno nello stomaco

Briatore ha INGERITO qualcosa di letale.
Alle 22:45 ha mangiato il suo piatto preferito: risotto al tartufo.
Una porzione preparata SOLO per lui.

ğŸ‘¨â€ğŸ³ Chi l'ha preparato? KRONK, la chef della serata.

ğŸ˜± Kronk ha un segreto terribile:
Sua sorella Sofia lavorava sullo yacht di Briatore tre anni fa.
Una notte, Briatore l'ha AGGREDITA.
Sofia oggi Ã¨ in una clinica psichiatrica.

Kronk aveva il MOVENTE PERFETTO. E l'ACCESSO al cibo.

âš ï¸ MA QUALCOSA NON TORNA:
Dalle 22:40 alle 23:15, Kronk era FUORI dalla cucina.
Era nel cortile a fumare. Ci sono testimoni.

Il risotto era pronto alle 22:30.
Ãˆ stato servito a Briatore alle 22:45.
Per 15 MINUTI, il piatto Ã¨ rimasto in cucina. INCUSTODITO.

ğŸ¯ CHI Ã¨ entrato in cucina in quei 15 minuti?`
      },
      { 
        id: 4, 
        titolo: 'ğŸ“© INDIZIO #4 - FINALE - Le Contraddizioni',
        contenuto: `ğŸš¨ PROVE DECISIVE

1ï¸âƒ£ LA CONTRADDIZIONE:
Bradley Cooper ha dichiarato di essere in sala massaggi (22:20-22:45).
Ma un lavapiatti l'ha visto USCIRE dalla cucina alle 22:40.
Se era in sala massaggi, come poteva essere in cucina?

2ï¸âƒ£ LA FOTO:
Nel portafoglio di Bradley Cooper c'Ã¨ una foto. Una ragazza giovane.
Dice "Ã¨ una fan". Ma perchÃ© tenerla nel portafoglio?
La ragazza Ã¨ SOFIA. La sorella di Kronk.

3ï¸âƒ£ IL COLLEGAMENTO NASCOSTO:
Sofia e Bradley erano FIDANZATI. In segreto. Per due anni.
Stavano per sposarsi. Poi Sofia ha lavorato per Briatore...
E dopo quella notte sullo yacht, si Ã¨ allontanata da tutti.

4ï¸âƒ£ IL MESSAGGIO:
Alle 22:00, Bradley ha mandato un SMS:
"Stasera finisce tutto. Per Sofia."

5ï¸âƒ£ LE COMPETENZE:
Per "American Sniper", Bradley ha studiato i veleni con consulenti militari.
Sa cos'Ã¨ la RICINA. Sa come si usa.

6ï¸âƒ£ LA DOMANDA A KRONK:
Bradley Ã¨ entrato in cucina alle 22:30.
Ha chiesto: "Qual Ã¨ il piatto di Briatore?"
Kronk glielo ha indicato. Lui si Ã¨ avvicinato "per sentire il profumo".

â° Ãˆ ORA DI VOTARE!
CHI ha ucciso Briatore? CON COSA? PERCHÃ‰?`
      }
    ];

    const ARMI = [
      { id: 'ricina', nome: 'Ricina nel Risotto', icona: 'ğŸš' },
      { id: 'cianuro', nome: 'Sigaro Avvelenato (Cianuro)', icona: 'ğŸš¬' },
      { id: 'siringa', nome: 'Siringa', icona: 'ğŸ’‰' },
      { id: 'champagne', nome: 'Champagne Avvelenato', icona: 'ğŸ¥‚' },
      { id: 'altro', nome: 'Altro', icona: 'â“' },
    ];

    const MOVENTI = [
      { id: 'vendetta_sofia', nome: 'Vendetta per Sofia', icona: 'ğŸ’”' },
      { id: 'ricatto', nome: 'Liberarsi dal ricatto', icona: 'ğŸ¤«' },
      { id: 'soldi', nome: 'Questioni di soldi', icona: 'ğŸ’°' },
      { id: 'carriera', nome: 'Proteggere la carriera', icona: 'ğŸ“ˆ' },
      { id: 'gelosia', nome: 'Gelosia', icona: 'ğŸ˜¤' },
    ];

    const MASTER_NAME = "Andrea";
    const STORAGE_KEY = 'billionaire_murder_2025';

    // Funzioni di storage sincronizzato
    const getGameState = () => {
      try {
        const data = localStorage.getItem(STORAGE_KEY);
        return data ? JSON.parse(data) : { fase: 0, avviato: false, countdownEnd: null };
      } catch { return { fase: 0, avviato: false, countdownEnd: null }; }
    };

    const setGameState = (state) => {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    };

    // Componenti
    const GlowText = ({ children }) => (
      <span className="bg-gradient-to-r from-amber-400 to-yellow-300 bg-clip-text text-transparent font-black">{children}</span>
    );

    const Countdown = ({ endTime, onComplete }) => {
      const [secondsLeft, setSecondsLeft] = useState(0);
      
      useEffect(() => {
        const update = () => {
          const now = Date.now();
          const remaining = Math.max(0, Math.ceil((endTime - now) / 1000));
          setSecondsLeft(remaining);
          if (remaining <= 0) onComplete();
        };
        update();
        const interval = setInterval(update, 100);
        return () => clearInterval(interval);
      }, [endTime, onComplete]);

      if (secondsLeft <= 0) return null;

      return (
        <div className="fixed inset-0 bg-black/90 z-50 flex items-center justify-center">
          <div className="text-center">
            <div className="relative">
              <div className="absolute inset-0 bg-amber-500/30 rounded-full pulse-ring"></div>
              <div className="text-8xl font-black text-amber-400 relative z-10">{secondsLeft}</div>
            </div>
            <p className="text-2xl text-white mt-6 animate-pulse">ğŸ“© Nuovo indizio in arrivo...</p>
          </div>
        </div>
      );
    };

    const VideoIntro = ({ onComplete }) => {
      const [fase, setFase] = useState(0);
      useEffect(() => {
        const t = [
          setTimeout(() => setFase(1), 500),
          setTimeout(() => setFase(2), 2500),
          setTimeout(() => setFase(3), 5000),
          setTimeout(() => setFase(4), 8000),
          setTimeout(() => setFase(5), 11000),
          setTimeout(() => setFase(6), 14000),
          setTimeout(() => onComplete(), 18000)
        ];
        return () => t.forEach(clearTimeout);
      }, []);

      return (
        <div className="fixed inset-0 bg-black z-50 flex items-center justify-center">
          <div className="absolute inset-0 bg-gradient-to-b from-purple-950/80 via-black to-black" />
          <div className="relative z-10 text-center px-6">
            {fase >= 1 && <div className={`transition-all duration-1000 ${fase >= 1 ? 'opacity-100' : 'opacity-0'}`}>
              <div className="text-7xl mb-4 float">ğŸ¬</div>
              <h1 className="text-3xl font-black mb-2"><GlowText>L'ULTIMA NOTTE</GlowText></h1>
              <h2 className="text-xl text-purple-300">AL BILLIONAIRE</h2>
            </div>}
            {fase >= 2 && <p className={`text-lg text-gray-400 italic my-4 transition-opacity duration-1000`}>Porto Cervo, Sardegna - Capodanno</p>}
            {fase >= 3 && <div className={`bg-slate-900/80 rounded-2xl p-4 max-w-sm mx-auto mb-4 transition-opacity duration-1000`}>
              <p className="text-gray-300 text-sm">Il Gran Gala dello Sport e dello Spettacolo... Le piÃ¹ grandi star del mondo riunite per celebrare il nuovo anno...</p>
            </div>}
            {fase >= 4 && <div className={`transition-opacity duration-1000`}>
              <div className="text-5xl mb-2">ğŸ’¼</div>
              <p className="text-xl text-white font-bold">FLAVIO BRIATORE</p>
              <p className="text-purple-300 text-sm">Il padrone di casa</p>
            </div>}
            {fase >= 5 && <div className={`mt-4 transition-opacity duration-500`}>
              <div className="text-6xl mb-2 animate-pulse">ğŸ’€</div>
              <p className="text-3xl font-black text-red-500 animate-pulse">TROVATO MORTO!</p>
              <p className="text-gray-400 text-sm mt-2">Ore 23:47 - Ufficio privato</p>
            </div>}
            {fase >= 6 && <div className={`mt-4 bg-red-900/50 border border-red-500/50 rounded-xl p-3 transition-opacity duration-1000`}>
              <p className="text-red-300 font-bold">QUALCUNO TRA VOI L'HA UCCISO</p>
              <p className="text-amber-400 mt-2 text-sm">ğŸ” Scoprite chi, come e perchÃ©!</p>
            </div>}
          </div>
          <button onClick={onComplete} className="absolute bottom-4 right-4 text-gray-500 hover:text-white text-sm">Salta â†’</button>
        </div>
      );
    };

    const VideoRivelazione = ({ onClose }) => {
      const [fase, setFase] = useState(0);
      const assassino = PERSONAGGI.find(p => p.nome === "Annastella");
      
      useEffect(() => {
        const t = [
          setTimeout(() => setFase(1), 1000),
          setTimeout(() => setFase(2), 4000),
          setTimeout(() => setFase(3), 7000),
          setTimeout(() => setFase(4), 10000)
        ];
        return () => t.forEach(clearTimeout);
      }, []);

      return (
        <div className="fixed inset-0 bg-black z-50 flex items-center justify-center overflow-y-auto py-8">
          <div className="absolute inset-0 bg-gradient-to-b from-red-950 via-black to-black" />
          <div className="relative z-10 text-center px-4 max-w-lg">
            {fase >= 1 && fase < 2 && <div><div className="text-6xl animate-pulse mb-6">âš–ï¸</div><p className="text-2xl text-gray-300">La veritÃ  sta per essere rivelata...</p></div>}
            {fase >= 2 && fase < 3 && <div><p className="text-xl text-gray-400 mb-4">L'assassino di Flavio Briatore Ã¨...</p><div className="text-7xl animate-bounce">â“</div></div>}
            {fase >= 3 && <div className="bg-gradient-to-b from-red-900/80 to-black/80 rounded-2xl border-2 border-red-500 p-4">
              <div className="text-5xl mb-2">{assassino.icona}</div>
              <p className="text-lg text-red-400">L'ASSASSINO Ãˆ</p>
              <p className="text-3xl font-black text-white mb-1">{assassino.celebrita.toUpperCase()}</p>
              <p className="text-purple-300 text-sm">({assassino.nome} - "{assassino.soprannome}")</p>
              {fase >= 4 && <div className="mt-4 pt-4 border-t border-red-500/30 text-left text-sm space-y-2">
                <p className="text-gray-300"><span className="text-amber-400">ğŸš ARMA:</span> Ricina nel risotto</p>
                <p className="text-gray-300"><span className="text-amber-400">ğŸ’” MOVENTE:</span> Vendetta per Sofia, l'amore della sua vita</p>
                <p className="text-gray-300"><span className="text-amber-400">ğŸ“– STORIA:</span> Bradley e Sofia erano fidanzati in segreto. Briatore ha violentato Sofia sullo yacht. Lei ha tentato il suicidio un anno fa e ha confessato tutto in una lettera. Bradley ha pianificato la vendetta perfetta.</p>
                <div className="mt-3 p-2 bg-slate-800/50 rounded-lg">
                  <p className="text-amber-400 font-bold text-xs">âš ï¸ FALSE PISTE:</p>
                  <p className="text-gray-400 text-xs">â€¢ Del Piero ha avvelenato i sigari â†’ Ma Briatore non li ha fumati</p>
                  <p className="text-gray-400 text-xs">â€¢ Will Smith ha tentato con la siringa â†’ Ma Briatore era giÃ  morto</p>
                  <p className="text-gray-400 text-xs">â€¢ Kronk sembrava colpevole â†’ Ma era fuori dalla cucina</p>
                </div>
              </div>}
            </div>}
            {fase >= 4 && <div className="mt-4">
              <p className="text-xl text-amber-400 font-bold mb-4">ğŸ¬ FINE ğŸ¬</p>
              <button onClick={onClose} className="bg-amber-500 text-black font-bold py-2 px-6 rounded-xl">Chiudi</button>
            </div>}
          </div>
        </div>
      );
    };

    const Scheda = ({ personaggio }) => (
      <div className="bg-slate-900/90 rounded-2xl border border-purple-500/30 p-3 space-y-3">
        <div className="text-center border-b border-purple-500/20 pb-3">
          <div className="text-5xl mb-2">{personaggio.icona}</div>
          <h2 className="text-xl font-bold text-white">{personaggio.celebrita}</h2>
          <p className="text-purple-300 italic text-sm">{personaggio.ruolo}</p>
          <p className="text-gray-400 text-xs">Giocatore: {personaggio.nome} "{personaggio.soprannome}"</p>
        </div>
        <div><h3 className="text-amber-400 font-bold text-sm mb-1">ğŸ“– CHI SEI</h3><p className="text-gray-300 text-xs whitespace-pre-line">{personaggio.background}</p></div>
        <div className="bg-red-900/20 border border-red-500/30 rounded-xl p-2"><h3 className="text-red-400 font-bold text-sm mb-1">ğŸ”’ IL TUO SEGRETO</h3><p className="text-gray-300 text-xs whitespace-pre-line">{personaggio.segreto}</p></div>
        <div className="bg-slate-800/50 border border-slate-600/30 rounded-xl p-2"><h3 className="text-gray-400 font-bold text-sm mb-1">ğŸ“ DOVE TI TROVAVI</h3><p className="text-gray-300 text-xs whitespace-pre-line">{personaggio.alibi}</p></div>
        <div className="bg-blue-900/20 border border-blue-500/30 rounded-xl p-2"><h3 className="text-blue-400 font-bold text-sm mb-1">âš¡ IL TUO POTERE</h3><p className="text-gray-300 text-xs">{personaggio.potere}</p></div>
        <div className="bg-amber-900/20 border border-amber-500/30 rounded-xl p-2"><h3 className="text-amber-400 font-bold text-sm mb-1">ğŸ¯ OBIETTIVO</h3><p className="text-gray-300 text-xs">Scopri chi ha ucciso Briatore! Vota: CHI, CON COSA, PERCHÃ‰.</p></div>
      </div>
    );

    const MasterPanel = ({ fase, onAvvia, onIndizio, onRivela, giocoAvviato }) => {
      const [countdown, setCountdown] = useState(10);
      const [releasing, setReleasing] = useState(false);

      const handleRilasciaIndizio = () => {
        if (fase >= 4) return;
        setReleasing(true);
        setCountdown(10);
        
        // Imposta il countdown end time per tutti
        const endTime = Date.now() + 10000;
        const state = getGameState();
        setGameState({ ...state, countdownEnd: endTime });
      };

      useEffect(() => {
        if (!releasing) return;
        if (countdown <= 0) {
          setReleasing(false);
          onIndizio();
          return;
        }
        const timer = setTimeout(() => setCountdown(c => c - 1), 1000);
        return () => clearTimeout(timer);
      }, [releasing, countdown, onIndizio]);

      return (
        <div className="bg-amber-900/30 border-2 border-amber-500 rounded-2xl p-3 mb-3">
          <h2 className="text-amber-400 font-bold mb-3 flex items-center gap-2 text-sm">
            ğŸ‘‘ PANNELLO MASTER <span className="text-xs bg-amber-500 text-black px-2 rounded">Solo tu vedi questo</span>
          </h2>
          
          {!giocoAvviato ? (
            <button onClick={onAvvia} className="w-full py-3 rounded-xl font-bold bg-green-600 text-white hover:bg-green-700 transition">
              ğŸ¬ AVVIA IL GIOCO
            </button>
          ) : releasing ? (
            <div className="text-center py-4">
              <div className="text-5xl font-black text-amber-400 animate-pulse">{countdown}</div>
              <p className="text-gray-300 text-sm mt-2">Rilascio indizio #{fase + 1}...</p>
            </div>
          ) : (
            <div className="space-y-2">
              <div className="flex items-center justify-between text-sm">
                <span className="text-gray-300">Indizi rilasciati:</span>
                <span className="text-amber-400 font-bold">{fase}/4</span>
              </div>
              <div className="w-full bg-slate-700 rounded-full h-2">
                <div className="bg-amber-500 h-2 rounded-full transition-all" style={{width: `${(fase/4)*100}%`}}></div>
              </div>
              
              {fase < 4 ? (
                <button onClick={handleRilasciaIndizio} className="w-full py-2 rounded-xl font-bold bg-purple-600 text-white hover:bg-purple-700 transition text-sm">
                  ğŸ“© RILASCIA INDIZIO #{fase + 1}
                </button>
              ) : (
                <div className="text-green-400 text-center text-sm py-2">âœ… Tutti gli indizi rilasciati!</div>
              )}
              
              <button onClick={onRivela} className="w-full py-2 rounded-xl font-bold bg-red-600 text-white hover:bg-red-700 transition text-sm">
                ğŸ’€ RIVELA L'ASSASSINO
              </button>
            </div>
          )}
        </div>
      );
    };

    const Login = ({ onLogin }) => {
      const [selected, setSelected] = useState(null);

      return (
        <div className="min-h-screen bg-gradient-to-b from-slate-950 via-purple-950 to-slate-950 flex items-center justify-center p-4">
          <div className="max-w-md w-full">
            <div className="text-center mb-5">
              <div className="text-5xl mb-2 float">ğŸ¬</div>
              <h1 className="text-2xl font-bold"><GlowText>L'ULTIMA NOTTE</GlowText></h1>
              <h2 className="text-lg text-purple-300">AL BILLIONAIRE</h2>
              <p className="text-gray-400 italic text-sm mt-1">Cena con Delitto - Capodanno 2025</p>
            </div>
            <div className="bg-slate-900/80 rounded-2xl border border-purple-500/30 p-4">
              <h2 className="text-amber-400 font-bold mb-3 text-center">Chi sei?</h2>
              <div className="grid grid-cols-2 gap-2 max-h-80 overflow-y-auto">
                {PERSONAGGI.map(p => (
                  <button key={p.nome} onClick={() => setSelected(p)}
                    className={`p-3 rounded-xl text-left transition ${
                      selected?.nome === p.nome 
                        ? 'bg-purple-600 border-2 border-amber-400' 
                        : p.nome === MASTER_NAME 
                          ? 'bg-amber-900/30 border-2 border-amber-500 hover:bg-amber-900/50' 
                          : 'bg-slate-800/50 border border-slate-700 hover:bg-slate-700/50'
                    }`}>
                    <div className="flex items-center gap-2">
                      <span className="text-2xl">{p.icona}</span>
                      <div>
                        <div className="text-white font-medium text-sm">{p.nome} {p.nome === MASTER_NAME && 'ğŸ‘‘'}</div>
                        <div className="text-gray-400 text-xs">"{p.soprannome}"</div>
                      </div>
                    </div>
                  </button>
                ))}
              </div>
              
              {selected && (
                <div className="mt-4 pt-4 border-t border-slate-700">
                  <div className="bg-slate-800/50 rounded-xl p-3 mb-3">
                    <div className="flex items-center gap-3">
                      <span className="text-4xl">{selected.icona}</span>
                      <div>
                        <div className="text-white font-bold">{selected.celebrita}</div>
                        <div className="text-purple-300 text-sm">{selected.ruolo}</div>
                        <div className="text-gray-400 text-xs">Giocatore: {selected.nome} "{selected.soprannome}"</div>
                      </div>
                    </div>
                  </div>
                  {selected.nome === MASTER_NAME && (
                    <div className="bg-amber-900/30 border border-amber-500/50 rounded-xl p-2 mb-3 text-center">
                      <p className="text-amber-400 text-sm font-bold">ğŸ‘‘ Sei il MASTER!</p>
                      <p className="text-gray-400 text-xs">Controllerai il rilascio degli indizi</p>
                    </div>
                  )}
                  <button onClick={() => onLogin({ personaggio: selected, isMaster: selected.nome === MASTER_NAME })}
                    className="w-full py-3 rounded-xl font-bold bg-amber-500 text-black hover:bg-amber-400 transition">
                    ğŸ¬ ENTRA NEL GIOCO
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    const Game = ({ utente }) => {
      const [gameState, setLocalGameState] = useState(getGameState);
      const [showIntro, setShowIntro] = useState(false);
      const [showRiv, setShowRiv] = useState(false);
      const [appunti, setAppunti] = useState(() => localStorage.getItem('appunti_' + utente.personaggio.nome) || '');
      const [accusa, setAccusa] = useState({});
      const [accusaOk, setAccusaOk] = useState(false);
      const [notifica, setNotifica] = useState('');
      const [tab, setTab] = useState('scheda');
      const [letto, setLetto] = useState(false);
      const [showCountdown, setShowCountdown] = useState(false);

      const { fase, avviato, countdownEnd } = gameState;
      const isMaster = utente.isMaster;
      const votaOk = fase >= 4;

      // Polling per sincronizzare lo stato tra dispositivi
      useEffect(() => {
        const poll = setInterval(() => {
          const newState = getGameState();
          setLocalGameState(prev => {
            if (JSON.stringify(prev) !== JSON.stringify(newState)) {
              // Notifica se c'Ã¨ un nuovo indizio
              if (newState.fase > prev.fase && newState.fase > 0) {
                setNotifica(`ğŸ“© Indizio #${newState.fase} disponibile!`);
                setTab('indizi');
                setTimeout(() => setNotifica(''), 4000);
              }
              return newState;
            }
            return prev;
          });
          
          // Controlla countdown
          if (newState.countdownEnd && Date.now() < newState.countdownEnd) {
            setShowCountdown(true);
          }
        }, 1000);
        return () => clearInterval(poll);
      }, []);

      // Salva appunti
      useEffect(() => {
        localStorage.setItem('appunti_' + utente.personaggio.nome, appunti);
      }, [appunti, utente.personaggio.nome]);

      const handleAvvia = () => {
        setShowIntro(true);
      };

      const handleIntroComplete = () => {
        setShowIntro(false);
        const newState = { ...gameState, avviato: true };
        setGameState(newState);
        setLocalGameState(newState);
      };

      const handleRilasciaIndizio = useCallback(() => {
        if (fase >= 4) return;
        const newState = { ...gameState, fase: fase + 1, countdownEnd: null };
        setGameState(newState);
        setLocalGameState(newState);
        setNotifica(`ğŸ“© Indizio #${fase + 1} rilasciato!`);
        setTab('indizi');
        setTimeout(() => setNotifica(''), 4000);
      }, [fase, gameState]);

      const handleCountdownComplete = useCallback(() => {
        setShowCountdown(false);
      }, []);

      // Schermata lettura scheda iniziale
      if (!letto) return (
        <div className="min-h-screen bg-gradient-to-b from-slate-950 via-purple-950 to-slate-950 p-4">
          <div className="max-w-md mx-auto">
            <h1 className="text-xl font-bold text-white mb-3 text-center">ğŸ“„ La Tua Scheda Personaggio</h1>
            <p className="text-gray-400 text-center text-sm mb-4">Leggila attentamente e memorizza il tuo ruolo!</p>
            <Scheda personaggio={utente.personaggio} />
            <button onClick={() => setLetto(true)} className="w-full mt-4 py-3 rounded-xl font-bold bg-amber-500 text-black hover:bg-amber-400 transition">
              âœ… HO LETTO, SONO PRONTO!
            </button>
          </div>
        </div>
      );

      // Schermata attesa avvio
      if (!avviato && !showIntro) return (
        <div className="min-h-screen bg-gradient-to-b from-slate-950 via-purple-950 to-slate-950 flex items-center justify-center p-4">
          <div className="text-center max-w-sm">
            <div className="text-5xl mb-4 float">ğŸ¬</div>
            {isMaster ? (
              <>
                <h1 className="text-xl font-bold text-amber-400 mb-3">ğŸ‘‘ Sei il Master!</h1>
                <p className="text-gray-400 mb-6 text-sm">Quando tutti hanno letto la loro scheda, avvia il gioco!</p>
                <button onClick={handleAvvia} className="py-3 px-8 rounded-xl font-bold bg-green-600 text-white hover:bg-green-700 transition">
                  ğŸ¬ AVVIA IL GIOCO
                </button>
              </>
            ) : (
              <>
                <h1 className="text-xl font-bold text-white mb-3">In attesa dell'avvio...</h1>
                <p className="text-gray-400 text-sm">Il Master (Andrea) avvierÃ  il gioco</p>
                <div className="mt-6 animate-pulse text-purple-400 text-4xl">â³</div>
              </>
            )}
          </div>
        </div>
      );

      if (showIntro) return <VideoIntro onComplete={handleIntroComplete} />;
      if (showRiv) return <VideoRivelazione onClose={() => setShowRiv(false)} />;
      if (showCountdown && countdownEnd) return <Countdown endTime={countdownEnd} onComplete={handleCountdownComplete} />;

      return (
        <div className="min-h-screen bg-gradient-to-b from-slate-950 via-purple-950 to-slate-950 pb-16">
          {notifica && (
            <div className="fixed top-3 left-1/2 -translate-x-1/2 z-50 bg-amber-500 text-black px-4 py-2 rounded-full font-bold text-sm animate-bounce">
              ğŸ”” {notifica}
            </div>
          )}
          
          {/* Header */}
          <div className="bg-slate-900/90 border-b border-purple-500/30 p-2 sticky top-0 z-40">
            <div className="flex items-center justify-between max-w-md mx-auto">
              <div className="flex items-center gap-2">
                <span className="text-2xl">{utente.personaggio.icona}</span>
                <div>
                  <div className="text-white font-semibold text-sm">{utente.personaggio.celebrita}</div>
                  <div className="text-gray-400 text-xs">{utente.personaggio.nome} {isMaster && 'ğŸ‘‘'}</div>
                </div>
              </div>
              <div className="text-amber-400 font-bold text-sm">Indizi: {fase}/4</div>
            </div>
          </div>

          <div className="max-w-md mx-auto p-3 space-y-3">
            {/* Master Panel */}
            {isMaster && (
              <MasterPanel 
                fase={fase} 
                giocoAvviato={avviato}
                onAvvia={handleAvvia}
                onIndizio={handleRilasciaIndizio}
                onRivela={() => setShowRiv(true)}
              />
            )}

            {/* Status */}
            <div className="bg-slate-900/90 rounded-xl border border-purple-500/30 p-3 text-center text-sm">
              {fase === 0 ? (
                <p className="text-gray-400">â³ In attesa del primo indizio...</p>
              ) : fase < 4 ? (
                <p className="text-purple-300">ğŸ” Indaga! Interroga! Usa il tuo potere!</p>
              ) : (
                <p className="text-green-400 font-bold animate-pulse">âœ… Tutti gli indizi sono stati rilasciati! Ãˆ ORA DI VOTARE!</p>
              )}
            </div>

            {/* Tabs */}
            <div className="flex gap-1">
              {['scheda', 'indizi', 'appunti', 'accusa'].map(t => (
                <button key={t} onClick={() => setTab(t)}
                  className={`flex-1 py-2 rounded-xl font-semibold text-xs transition ${
                    tab === t 
                      ? (t === 'accusa' ? (votaOk ? 'bg-green-600 text-white' : 'bg-slate-600 text-gray-300') : 'bg-purple-600 text-white') 
                      : 'bg-slate-800 text-gray-400 hover:bg-slate-700'
                  }`}>
                  {t === 'scheda' && 'ğŸ“„'}{t === 'indizi' && 'ğŸ“‚'}{t === 'appunti' && 'ğŸ“'}{t === 'accusa' && (votaOk ? 'âœ…' : 'ğŸ”’')} {t.charAt(0).toUpperCase() + t.slice(1)}
                </button>
              ))}
            </div>

            {/* Tab Content */}
            {tab === 'scheda' && <Scheda personaggio={utente.personaggio} />}

            {tab === 'indizi' && (
              <div className="bg-slate-900/90 rounded-xl border border-purple-500/30 p-3">
                <h2 className="text-amber-400 font-bold mb-3 text-sm">ğŸ“‚ Indizi Raccolti ({fase}/4)</h2>
                {fase === 0 ? (
                  <p className="text-gray-500 text-center py-8 text-sm">Nessun indizio ancora rilasciato...</p>
                ) : (
                  <div className="space-y-3 max-h-96 overflow-y-auto">
                    {INDIZI.slice(0, fase).map(i => (
                      <div key={i.id} className="bg-slate-800/50 rounded-xl p-3 border border-slate-700">
                        <div className="text-amber-400 font-semibold text-sm mb-2">{i.titolo}</div>
                        <div className="text-gray-300 text-xs whitespace-pre-line">{i.contenuto}</div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            )}

            {tab === 'appunti' && (
              <div className="bg-slate-900/90 rounded-xl border border-purple-500/30 p-3">
                <h2 className="text-amber-400 font-bold mb-2 text-sm">ğŸ“ I Tuoi Appunti</h2>
                <p className="text-gray-500 text-xs mb-2">Scrivi qui i tuoi sospetti e le tue deduzioni...</p>
                <textarea 
                  value={appunti} 
                  onChange={e => setAppunti(e.target.value)} 
                  placeholder="Chi sospetti? Quali contraddizioni hai notato? Chi aveva un movente?" 
                  className="w-full h-56 bg-slate-800/50 border border-slate-700 rounded-xl p-3 text-gray-300 text-sm resize-none focus:border-purple-500 focus:outline-none" 
                />
              </div>
            )}

            {tab === 'accusa' && (
              <div className="bg-slate-900/90 rounded-xl border border-purple-500/30 p-3">
                <h2 className="text-amber-400 font-bold mb-3 text-sm">âš–ï¸ La Tua Accusa</h2>
                {!votaOk ? (
                  <div className="text-center py-8">
                    <div className="text-5xl mb-3">ğŸ”’</div>
                    <p className="text-gray-400 text-sm">Devi aspettare tutti gli indizi!</p>
                    <p className="text-gray-500 text-xs mt-1">Mancano ancora {4 - fase} indizi</p>
                  </div>
                ) : accusaOk ? (
                  <div className="text-center py-8">
                    <div className="text-5xl mb-3">âœ…</div>
                    <p className="text-green-400 font-bold">Accusa registrata!</p>
                    <div className="mt-4 text-left bg-slate-800/50 rounded-xl p-3 text-sm">
                      <p className="text-gray-300"><span className="text-amber-400">Chi:</span> {accusa.chi}</p>
                      <p className="text-gray-300"><span className="text-amber-400">Arma:</span> {ARMI.find(a => a.id === accusa.arma)?.nome}</p>
                      <p className="text-gray-300"><span className="text-amber-400">Movente:</span> {MOVENTI.find(m => m.id === accusa.motivo)?.nome}</p>
                    </div>
                  </div>
                ) : (
                  <div className="space-y-3">
                    <div>
                      <label className="text-gray-400 text-xs mb-1 block">ğŸ¯ CHI ha ucciso Briatore?</label>
                      <select value={accusa.chi || ''} onChange={e => setAccusa({...accusa, chi: e.target.value})}
                        className="w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white text-sm focus:border-purple-500 focus:outline-none">
                        <option value="">Seleziona...</option>
                        {PERSONAGGI.map(p => <option key={p.nome} value={p.nome}>{p.celebrita} ({p.nome})</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="text-gray-400 text-xs mb-1 block">ğŸ”ª CON COSA?</label>
                      <select value={accusa.arma || ''} onChange={e => setAccusa({...accusa, arma: e.target.value})}
                        className="w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white text-sm focus:border-purple-500 focus:outline-none">
                        <option value="">Seleziona...</option>
                        {ARMI.map(a => <option key={a.id} value={a.id}>{a.icona} {a.nome}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="text-gray-400 text-xs mb-1 block">â“ PERCHÃ‰?</label>
                      <select value={accusa.motivo || ''} onChange={e => setAccusa({...accusa, motivo: e.target.value})}
                        className="w-full bg-slate-800 border border-slate-700 rounded-xl px-3 py-2 text-white text-sm focus:border-purple-500 focus:outline-none">
                        <option value="">Seleziona...</option>
                        {MOVENTI.map(m => <option key={m.id} value={m.id}>{m.icona} {m.nome}</option>)}
                      </select>
                    </div>
                    <button 
                      onClick={() => setAccusaOk(true)} 
                      disabled={!accusa.chi || !accusa.arma || !accusa.motivo}
                      className={`w-full py-3 rounded-xl font-bold transition ${
                        accusa.chi && accusa.arma && accusa.motivo 
                          ? 'bg-green-600 text-white hover:bg-green-700' 
                          : 'bg-slate-700 text-slate-500 cursor-not-allowed'
                      }`}>
                      âš–ï¸ CONFERMA ACCUSA
                    </button>
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      );
    };

    const App = () => {
      const [utente, setUtente] = useState(null);
      return utente ? <Game utente={utente} /> : <Login onLogin={setUtente} />;
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
